<!DOCTYPE html>
<html>
<head>
    <title>Index of /uploads</title>
    <!-- <link rel="stylesheet" href="/static/style.css"> -->
     <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

</head>
<body>
    <header>
        <h1>Nati</h1>
        <div class="team">File Manager</div>
    </header>
    <main style="position: relative;">
        <a href="/logout" style="float: right; margin-bottom: 12px;">Logout</a>
        <!-- Change Password Button -->
        <button id="changePassBtn" style="position: absolute; top: 18px; left: 18px; font-size: 0.95rem; padding: 6px 14px; background: #eee; color: #444; border: 1px solid #ddd; border-radius: 6px; cursor: pointer;">Change Password</button>
        <div style="clear: both;"></div>
        {% with messages = get_flashed_messages() %}
            {% if messages %}
                <ul class="flash">
                    {% for message in messages %}
                        <li>{{ message }}</li>
                    {% endfor %}
                </ul>
            {% endif %}
        {% endwith %}
        <form method="POST" enctype="multipart/form-data">
            <input type="file" name="file" required>
            <button type="submit">Upload</button>
        </form>
        <ul>
            {% for file in files %}
                <li>
                    <a href="/uploads/{{ file }}">{{ file }}</a>
                    <form method="POST" style="display:inline;">
                        <input type="hidden" name="delete" value="{{ file }}">
                        <button type="submit">Delete</button>
                    </form>
                    <form method="POST" style="display:inline;">
                        <input type="hidden" name="rename_old" value="{{ file }}">
                        <input type="text" name="rename_new" placeholder="New name" required>
                        <button type="submit">Rename</button>
                    </form>
                </li>
            {% endfor %}
        </ul>

        <!-- Change Password Modal -->
        <div id="changePassModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:#0005; z-index:1000; align-items:center; justify-content:center;">
            <form method="POST" style="background:#fff; color:#222; border-radius:10px; box-shadow:0 2px 12px #0003; padding:28px 22px; min-width:260px; display:flex; flex-direction:column; gap:12px; align-items:center;" onsubmit="return confirm('Are you sure you want to change the password?');">
                <h3 style="margin:0 0 8px 0; font-size:1.1rem;">Change Password</h3>
                <input type="password" name="new_password" placeholder="New Password" required>
                <button type="submit" name="change_password" style="width:100%;">Save</button>
                <button type="button" onclick="closeChangePassModal()" style="background:#eee; color:#444; margin-top:4px;">Cancel</button>
            </form>
        </div>
    </main>
<script>
  const btn = document.getElementById('changePassBtn');
  const modal = document.getElementById('changePassModal');
  btn.onclick = () => { modal.style.display = 'flex'; };
  function closeChangePassModal() { modal.style.display = 'none'; }
  window.onclick = function(event) {
    if(event.target === modal) closeChangePassModal();
  }
</script>
</body>
</html>
